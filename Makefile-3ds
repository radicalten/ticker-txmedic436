.SUFFIXES:
export DEVKITPRO 	:= /opt/devkitpro
export DEVKITARM	:= $(DEVKITPRO)/devkitARM
include $(DEVKITARM)/3ds_rules
CC 					:= $(DEVKITARM)/bin/arm-none-eabi-gcc
MACHDEP := -D__3DS__ -march=armv6k -mtune=mpcore -mfloat-abi=hard -mtp=soft -mword-relocations -ffunction-sections
INCLUDES += -I/opt/devkitpro/portlibs/3ds/include -I/opt/devkitpro/portlibs/arm-none-eabi/include -I/opt/devkitpro/libctru/include
CFLAGS 	:= -O3 -flto \
$(INCLUDES) $(MACHDEP)
LDFLAGS := $(CFLAGS) \
-L/opt/devkitpro/portlibs/3ds/lib \
-L/opt/devkitpro/portlibs/arm-none-eabi/lib \
-L/opt/devkitpro/libctru/lib \
-L/opt/devkitpro/libctru/lib/3ds \
-lctru -lcurl -lm
TARGET  := myapp
SRCS    := $(wildcard 3ds/*.c)
OBJS    := $(patsubst %.c,%.o,$(SRCS))
all: $(OBJS)
	$(CC) $(OBJS) $(CFLAGS) $(LDFLAGS) -o $(TARGET) 
